(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{17:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(1),o=n.n(c),i=n(8),s=n.n(i),r=(n(17),n(11)),l=n(2),u=n.p+"static/media/logo.a307e1c4.svg";var d=function(){return Object(a.jsx)("header",{className:"header",children:Object(a.jsx)("img",{src:u,alt:"\u043b\u043e\u0433\u043e\u0442\u0438\u043f \u043c\u0435\u0441\u0442\u043e \u0440\u043e\u0441\u0441\u0438\u044f",className:"logo"})})},p=o.a.createContext(),b=function(e){var t=o.a.useContext(p),n=e.card.owner._id===t._id,c="button place__del-btn ".concat(n?"":"place__del-btn_disable"),i=e.card.likes.some((function(e){return e._id===t._id})),s="button place__like-btn ".concat(i?"place__like-btn_active":""),r="paragraph ".concat(i?"paragraph_red":"");return Object(a.jsxs)("li",{className:"place",children:[Object(a.jsx)("button",{type:"button",className:c,"aria-label":"\u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043c\u0435\u0441\u0442\u043e",onClick:function(){e.onCardDelete(e.card)}}),Object(a.jsx)("button",{type:"button",className:"button place__img-btn",children:Object(a.jsx)("img",{src:e.card.link,alt:e.card.name,className:"place__image",onClick:function(){e.onCardClick(e.card)}})}),Object(a.jsxs)("div",{className:"place__info",children:[Object(a.jsx)("h2",{className:"place__title",children:e.card.name}),Object(a.jsxs)("div",{className:"place__like-area",children:[Object(a.jsx)("button",{type:"button",className:s,"aria-label":"\u043f\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043b\u0430\u0439\u043a",onClick:function(){e.onCardLike(e.card)}}),Object(a.jsx)("p",{className:r,children:e.card.likes.length})]})]})]})},j=function(e){var t=Object(c.useContext)(p);return Object(a.jsxs)("main",{className:"main",children:[Object(a.jsxs)("section",{className:"profile",children:[Object(a.jsxs)("div",{className:"profile__avatar-area",children:[Object(a.jsx)("img",{src:t.avatar,alt:t.name,className:"profile__avatar"}),Object(a.jsx)("button",{type:"button",className:"profile__avatar-btn","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",onClick:e.onEditAvatar})]}),Object(a.jsxs)("div",{className:"profile__info",children:[Object(a.jsxs)("div",{className:"profile__block-name",children:[Object(a.jsx)("h1",{className:"profile__name",children:t.name}),Object(a.jsx)("button",{type:"button",className:"button profile__edit-btn","aria-label":"\u043a\u043d\u043e\u043f\u043a\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",onClick:e.onEditProfile})]}),Object(a.jsx)("p",{className:"profile__job",children:t.about})]}),Object(a.jsx)("button",{type:"button",className:"button profile__add-btn","aria-label":"\u043a\u043d\u043e\u043f\u043a\u0430 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0435\u0441\u0442\u043e",onClick:e.onAddPlace})]}),Object(a.jsx)("ul",{className:"places",children:e.cards.map((function(t){return Object(a.jsx)(b,{card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete},t._id)}))})]})};var f=function(){return Object(a.jsx)("footer",{className:"footer",children:Object(a.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Mesto Russia"})})},h=function(e){var t=e.isOpen,n="popup popup-zoom ".concat(t?"popup_opened":"");return Object(a.jsx)("section",{className:n,onClick:e.onClose,children:Object(a.jsxs)("figure",{className:"popup-zoom__container",onClick:function(e){return e.stopPropagation()},children:[Object(a.jsx)("button",{type:"button",className:"button popup__close-btn","aria-label":"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443",onClick:e.onClose}),Object(a.jsx)("img",{src:e.card.link,alt:e.card.name,className:"popup-zoom__image"}),Object(a.jsx)("figcaption",{className:"popup-zoom__caption",children:e.card.name})]})})},m=n(3),O=function(e){var t="popup ".concat(e.isOpen?"popup_opened":"");return Object(a.jsx)("section",{className:t,onClick:e.onClose,children:Object(a.jsxs)("form",{className:"popup__container",method:"post",noValidate:!0,onClick:function(e){return e.stopPropagation()},onSubmit:e.onSubmit,children:[Object(a.jsx)("button",{type:"button",className:"button popup__close-btn","aria-label":"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443",onClick:e.onClose}),Object(a.jsx)("h2",{className:"popup__title",children:e.title}),e.children,Object(a.jsx)("button",{type:"submit",className:"popup__save-btn ".concat(e.onValid?"":"popup__save-btn_inactive"),"aria-label":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u043f\u0440\u043e\u0444\u0438\u043b\u044c",disabled:!e.onValid,children:e.button})]})})},_=function(e){var t=Object(c.useContext)(p),n=Object(c.useState)({name:"",nameErrorMessage:"",isNameValid:!0,description:"",descriptionErrorMessage:"",isDescriptionValid:!0,formValid:!1}),o=Object(l.a)(n,2),i=o[0],s=o[1];Object(c.useEffect)((function(){setTimeout((function(){s({name:t.name,nameErrorMessage:"",isNameValid:!0,description:t.about,descriptionErrorMessage:"",isDescriptionValid:!0,formValid:!1})}),500)}),[t,e.isOpen]);var r=function(){i.name.length+1<=3?s((function(e){return Object(m.a)(Object(m.a)({},e),{},{nameErrorMessage:"The name is too short",isNameValid:!1})})):i.name.length>30?s((function(e){return Object(m.a)(Object(m.a)({},e),{},{nameErrorMessage:"The name is too long",isNameValid:!1})})):s((function(e){return Object(m.a)(Object(m.a)({},e),{},{nameErrorMessage:"",isNameValid:!0})})),d()},u=function(){console.log(i.description.length),d()},d=function(){console.log(i.isNameValid,i.isDescriptionValid),i.isNameValid&&i.isDescriptionValid?s((function(e){return Object(m.a)(Object(m.a)({},e),{},{formValid:!0})})):s((function(e){return Object(m.a)(Object(m.a)({},e),{},{formValid:!1})}))};return Object(a.jsxs)(O,{isOpen:e.isOpen,onClose:function(){e.onClose()},title:"Edit profile",button:e.button,onSubmit:function(t){t.preventDefault(),e.onUpdateUser(i.name,i.description)},onValid:i.formValid,children:[Object(a.jsx)("input",{type:"text",className:"popup__input ".concat(i.isNameValid?"":"popup__input_invalid"),placeholder:"First and second name",value:i.name||"",onChange:function(e){s((function(t){return Object(m.a)(Object(m.a)({},t),{},{name:e.target.value})})),r()}}),Object(a.jsx)("span",{id:"fullName-error",className:"popup__input-error ".concat(i.isNameValid?"":"popup__input-error_active"),children:i.nameErrorMessage}),Object(a.jsx)("input",{type:"text",className:"popup__input",placeholder:"Profession",value:i.description||"",onChange:function(e){s((function(t){return Object(m.a)(Object(m.a)({},t),{},{description:e.target.value})})),u()}}),Object(a.jsx)("span",{id:"jobPosition-error",className:"popup__input-error",children:i.descriptionErrorMessage})]})},k=function(e){var t=Object(c.useState)({link:"",linkValid:!0,linkErrorMessage:"",formValid:!1}),n=Object(l.a)(t,2),o=n[0],i=n[1];Object(c.useEffect)((function(){setTimeout((function(){i({link:"",linkValid:!0,linkErrorMessage:"",formValid:!1})}),500)}),[e.isOpen]);return Object(a.jsxs)(O,{isOpen:e.isOpen,onClose:function(){e.onClose()},title:"Update avatar",button:e.button,onSubmit:function(t){t.preventDefault(),e.onUpdateAvatar({link:o.link})},onValid:o.formValid,children:[Object(a.jsx)("input",{type:"url",name:"link",className:"popup__input ".concat(o.linkValid?"":"popup__input_invalid"),placeholder:"Avatar's link",autoComplete:"off",value:o.link||"",onChange:function(e){var t;i(e.target.value),t=e.target.value,/^(ftp|http|https):\/\/[^ "]+$/.test(t)?i({link:t,linkValid:!0,linkErrorMessage:"",formValid:!0}):i({link:t,linkValid:!1,linkErrorMessage:"Check your link",formValid:!1})}}),Object(a.jsx)("span",{id:"avatarLink-error",className:"popup__input-error ".concat(o.formValid?"":"popup__input-error_active"),children:o.linkErrorMessage})]})},v=function(e){var t=Object(c.useRef)(""),n=Object(c.useRef)("");Object(c.useEffect)((function(){setTimeout((function(){o()}),500)}),[e.isOpen]);var o=function(){n.current.value="",t.current.value=""};return Object(a.jsxs)(O,{isOpen:e.isOpen,onClose:function(){e.onClose()},title:"New place",button:e.button,onSubmit:function(a){a.preventDefault(),e.onAddPlace({name:n.current.value,link:t.current.value,fn:o})},children:[Object(a.jsx)("input",{ref:n,type:"text",id:"placeName",name:"name",className:"popup__input popup__input_name-place",placeholder:"Title",autoComplete:"off",minLength:2,maxLength:30,required:!0}),Object(a.jsx)("span",{id:"placeName-error",className:"popup__input-error"}),Object(a.jsx)("input",{ref:t,type:"url",id:"placeLink",name:"link",className:"popup__input popup__input_link-place",placeholder:"Link to the picture",autoComplete:"off",required:!0}),Object(a.jsx)("span",{id:"placeLink-error",className:"popup__input-error"})]})},g=function(e){return Object(a.jsx)(O,{isOpen:e.isOpen,onClose:e.onClose,name:"del-place",title:"Are you shure?",button:e.button,onSubmit:function(t){t.preventDefault(),e.onConfirmDelete()}})},C=n(9),x=n(10),N=new(function(){function e(t){Object(C.a)(this,e),this.url=t.url,this.headers=t.headers}return Object(x.a)(e,[{key:"getPlaces",value:function(){return fetch("".concat(this.url,"/cards"),{headers:this.headers}).then(this._checkPromise)}},{key:"newPlace",value:function(e,t){return fetch("".concat(this.url,"/cards"),{method:"POST",headers:this.headers,body:JSON.stringify(e,t)}).then(this._checkPromise)}},{key:"getUserInfo",value:function(){return fetch("".concat(this.url,"/users/me"),{headers:this.headers}).then(this._checkPromise)}},{key:"patchUserInfo",value:function(e,t){return fetch("".concat(this.url,"/users/me"),{method:"PATCH",headers:this.headers,body:JSON.stringify(e,t)}).then(this._checkPromise)}},{key:"patchUserAvatar",value:function(e){return fetch("".concat(this.url,"/users/me/avatar"),{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then(this._checkPromise)}},{key:"changeLikeCardStatus",value:function(e,t){return t?this.removeLike(e):this.addLike(e)}},{key:"addLike",value:function(e){return fetch("".concat(this.url,"/cards/likes/").concat(e),{method:"PUT",headers:this.headers}).then(this._checkPromise)}},{key:"removeLike",value:function(e){return fetch("".concat(this.url,"/cards/likes/").concat(e),{method:"DELETE",headers:this.headers}).then(this._checkPromise)}},{key:"deleteCard",value:function(e){return fetch("".concat(this.url,"/cards/").concat(e),{method:"DELETE",headers:this.headers}).then(this._checkPromise)}},{key:"_checkPromise",value:function(e){return e.ok||Promise.reject("Error ".concat(e.status)),e.json()}}]),e}())({url:"https://mesto.nomoreparties.co/v1/cohort-18",headers:{"Content-Type":"application/json",authorization:"87b27e82-ce10-439c-bbe6-2acce8f72cdc"}}),y=n(4),E=n.n(y),S=function(){var e=Object(c.useState)([]),t=Object(l.a)(e,2),n=t[0],o=t[1],i=Object(c.useState)(""),s=Object(l.a)(i,2),u=s[0],b=s[1],m=Object(c.useState)(!1),O=Object(l.a)(m,2),C=O[0],x=O[1],y=Object(c.useState)(!1),S=Object(l.a)(y,2),P=S[0],V=S[1],L=Object(c.useState)(!1),w=Object(l.a)(L,2),D=w[0],M=w[1],T=Object(c.useState)(!1),A=Object(l.a)(T,2),U=A[0],I=A[1],z=Object(c.useState)(!1),F=Object(l.a)(z,2),J=F[0],R=F[1],q=Object(c.useState)(!1),B=Object(l.a)(q,2),H=B[0],Y=B[1],$=Object(c.useState)(""),G=Object(l.a)($,2),K=G[0],Q=G[1],W=Object(c.useState)("Save"),X=Object(l.a)(W,2),Z=X[0],ee=X[1],te=Object(c.useState)("Create"),ne=Object(l.a)(te,2),ae=ne[0],ce=ne[1],oe=Object(c.useState)("Yes!"),ie=Object(l.a)(oe,2),se=ie[0],re=ie[1];Object(c.useEffect)((function(){N.getUserInfo().then((function(e){b(e)})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430, \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f: ".concat(e.status))}))}),[]),Object(c.useEffect)((function(){N.getPlaces().then((function(e){o(e)})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043a\u0430\u0440\u0442\u043e\u0447\u0435\u043a \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430: ".concat(e.status))}))}),[]);var le=function(e){27===e.keyCode&&de()},ue=function(e){re("Deleting..."),N.deleteCard(e._id).then((function(t){console.log(t);var a=n.filter((function(t){return t._id!==e._id}));o(a)})).then((function(){return de()})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438: ".concat(e.status))}))},de=function(){M(!1),x(!1),V(!1),I(!1),R(!1),Q(""),ee("Save"),ce("Create"),re("Yes!"),window.removeEventListener("keydown",le),E.a.enablePageScroll()};return Object(a.jsxs)(p.Provider,{value:u,children:[Object(a.jsx)(d,{}),Object(a.jsx)(j,{cards:n,onEditAvatar:function(){M(!0),window.addEventListener("keydown",le),E.a.disablePageScroll()},onEditProfile:function(){x(!0),window.addEventListener("keydown",le),E.a.disablePageScroll()},onAddPlace:function(){V(!0),window.addEventListener("keydown",le),E.a.disablePageScroll()},onCardClick:function(e){Y(e),setTimeout((function(){R(!0)}),500),window.addEventListener("keydown",le),E.a.disablePageScroll()},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===u._id}));N.changeLikeCardStatus(e._id,t).then((function(t){var a=n.map((function(n){return n._id===e._id?t:n}));o(a)})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))},onCardDelete:function(e){I(!0),Q(e),window.addEventListener("keydown",le),E.a.disablePageScroll()}}),Object(a.jsx)(f,{}),Object(a.jsx)(k,{isOpen:D,button:Z,onClose:de,onUpdateAvatar:function(e){var t=e.link;ee("Saving..."),N.patchUserAvatar(t).then((function(e){b(e)})).then((function(){return de()})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0430\u0432\u0430\u0442\u0430\u0440\u0430: ".concat(e.status))}))}}),Object(a.jsx)(_,{isOpen:C,button:Z,onClose:de,onUpdateUser:function(e,t){ee("Saving..."),N.patchUserInfo({name:e,about:t}).then((function(e){b(e)})).then((function(){return de()})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u0440\u043e\u0444\u0438\u043b\u044f: ".concat(e.status))}))}}),Object(a.jsx)(v,{isOpen:P,button:ae,onClose:de,onAddPlace:function(e){var t=e.name,a=e.link,c=e.fn;ce("Adding..."),N.newPlace({name:t,link:a}).then((function(e){o([e].concat(Object(r.a)(n)))})).then((function(){return de()})).then((function(){return c()})).catch((function(e){console.log("\u041e\u0448\u0438\u0431\u043a\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438: ".concat(e.status))}))}}),Object(a.jsx)(g,{isOpen:U,button:se,onClose:de,onCardDelete:ue,onConfirmDelete:function(){ue(K),de()}}),Object(a.jsx)(h,{isOpen:J,card:H,onClose:de})]})},P=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,19)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),o(e),i(e)}))};s.a.render(Object(a.jsx)(o.a.StrictMode,{children:Object(a.jsx)(S,{})}),document.getElementById("root")),P()}},[[18,1,2]]]);
//# sourceMappingURL=main.9ef7690f.chunk.js.map